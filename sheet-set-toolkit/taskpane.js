/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e,t,n,r,o,a,c,s,u,l,i,p,d,f,h,m,v,g={385:function(e){e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},646:function(e,t,n){e.exports=n.p+"assets/AddRevision.png"},220:function(e,t,n){e.exports=n.p+"assets/Calender.png"},886:function(e,t,n){e.exports=n.p+"assets/CellFormula.png"},416:function(e,t,n){e.exports=n.p+"assets/CheckRevisionNumber.png"},909:function(e,t,n){e.exports=n.p+"assets/HighlightEmpty.png"},606:function(e,t,n){e.exports=n.p+"assets/IsolateSubsets.png"},410:function(e,t,n){e.exports=n.p+"assets/LetterCase.png"},914:function(e,t,n){e.exports=n.p+"assets/NonBreakingSpace.png"},655:function(e,t,n){e.exports=n.p+"assets/OtherFunctions.png"},682:function(e,t,n){e.exports=n.p+"assets/Revisions.png"},773:function(e,t,n){e.exports=n.p+"assets/Subsets.png"},931:function(e,t,n){e.exports=n.p+"assets/UnisolateSubsets.png"},111:function(e,t,n){e.exports=n.p+"assets/cell-picker.png"},852:function(e,t,n){e.exports=n.p+"assets/search-find.png"},394:function(e,t,n){e.exports=n.p+"99facec3a7f4783a7ab5.css"}},y={};function x(e){var t=y[e];if(void 0!==t)return t.exports;var n=y[e]={exports:{}};return g[e](n,n.exports,x),n.exports}x.m=g,x.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return x.d(t,{a:t}),t},x.d=function(e,t){for(var n in t)x.o(t,n)&&!x.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},x.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),x.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;x.g.importScripts&&(e=x.g.location+"");var t=x.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),x.p=e}(),x.b=document.baseURI||self.location.href,function(){var e=JSON.parse('[{"Name":"Urban Systems","Filters":[{"Filter":"^REV-LINE\\\\d\\\\d?-#$","IsIncrement":true,"IsPrepopulated":false,"Name":"REV-LINE#-#"},{"Filter":"^REV-LINE\\\\d\\\\d?-APP$","IsIncrement":false,"IsPrepopulated":false,"Name":"REV-LINE#-APP"},{"Filter":"^REV-LINE\\\\d\\\\d?-DATE$","IsIncrement":false,"IsPrepopulated":false,"Name":"REV-LINE#-DATE"},{"Filter":"^REV-LINE\\\\d\\\\d?-DESC$","IsIncrement":false,"IsPrepopulated":false,"Name":"REV-LINE#-DESC"}]},{"Name":"BC MoT","Filters":[{"Filter":"^Rev \\\\d\\\\d?$","IsIncrement":true,"IsPrepopulated":false,"Name":"Rev #"},{"Filter":"^Rev \\\\d\\\\d? Approved$","IsIncrement":false,"IsPrepopulated":false,"Name":"Rev # Approved"},{"Filter":"^Rev \\\\d\\\\d? Date$","IsIncrement":false,"IsPrepopulated":false,"Name":"Rev # Date"},{"Filter":"^Rev \\\\d\\\\d? Desc$","IsIncrement":false,"IsPrepopulated":false,"Name":"Rev # Desc"}]},{"Name":"CoC Sheets","Filters":[{"Filter":"^\\\\d\\\\d-ISSU-NO~(\\\\d\\\\d?)$","IsIncrement":true,"IsPrepopulated":false,"Name":"\\\\d\\\\d-ISSU-NO~(#)"},{"Filter":"^\\\\d\\\\d-ISSU-DES(\\\\d\\\\d?)$","IsIncrement":false,"IsPrepopulated":false,"Name":"\\\\d\\\\d-ISSU-DES(#)"},{"Filter":"^\\\\d\\\\d-ISSU-DAT(\\\\d\\\\d?)$","IsIncrement":false,"IsPrepopulated":false,"Name":"\\\\d\\\\d-ISSU-DAT(#)"},{"Filter":"^\\\\d\\\\d-ISSU-BY~(\\\\d\\\\d?)$","IsIncrement":false,"IsPrepopulated":false,"Name":"\\\\d\\\\d-ISSU-BY~(#)"},{"Filter":"^\\\\d\\\\d-ISSU-APP(\\\\d\\\\d?)$","IsIncrement":false,"IsPrepopulated":false,"Name":"\\\\d\\\\d-ISSU-APP(#)"}]},{"Name":"Calgary SubDiv","Filters":[{"Filter":"^REV\\\\d\\\\d?_NO$","IsIncrement":true,"IsPrepopulated":false,"Name":"REV#_NO"},{"Filter":"^REV\\\\d\\\\d?_DESC$","IsIncrement":false,"IsPrepopulated":false,"Name":"REV#_DESC"},{"Filter":"^REV\\\\d\\\\d?_DATE$","IsIncrement":false,"IsPrepopulated":false,"Name":"REV#_DATE"},{"Filter":"^REV\\\\d\\\\d?_APP$","IsIncrement":false,"IsPrepopulated":false,"Name":"REV#_APP"}]},{"Name":"Calgary DSSP","Filters":[{"Filter":"^REVISION \\\\d\\\\d?$","IsIncrement":true,"IsPrepopulated":true,"Name":"REVISION #"},{"Filter":"^REVISION \\\\d\\\\d? APPROVED BY$","IsIncrement":false,"IsPrepopulated":false,"Name":"REVISION # APPROVED BY"},{"Filter":"^REVISION \\\\d\\\\d? DATE$","IsIncrement":false,"IsPrepopulated":false,"Name":"REVISION # DATE"},{"Filter":"^REVISION \\\\d\\\\d? DESC$","IsIncrement":false,"IsPrepopulated":false,"Name":"REVISION # DESC"}]}]');function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(){r=function(){return n};var e,n={},o=Object.prototype,a=o.hasOwnProperty,c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function i(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{i({},"")}catch(e){i=function(e,t,n){return e[t]=n}}function p(t,n,r,o){var a=n&&n.prototype instanceof h?n:h,c=Object.create(a.prototype);return i(c,"_invoke",function(t,n,r){var o=1;return function(a,c){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===a)throw c;return{value:e,done:!0}}for(r.method=a,r.arg=c;;){var s=r.delegate;if(s){var u=I(s,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var l=d(t,n,r);if("normal"===l.type){if(o=r.done?4:2,l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=4,r.method="throw",r.arg=l.arg)}}}(t,r,new C(o||[])),!0),c}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=p;var f={};function h(){}function m(){}function v(){}var g={};i(g,s,(function(){return this}));var y=Object.getPrototypeOf,x=y&&y(y(R([])));x&&x!==o&&a.call(x,s)&&(g=x);var w=v.prototype=h.prototype=Object.create(g);function b(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,n){function r(o,c,s,u){var l=d(e[o],e,c);if("throw"!==l.type){var i=l.arg,p=i.value;return p&&"object"==t(p)&&a.call(p,"__await")?n.resolve(p.__await).then((function(e){r("next",e,s,u)}),(function(e){r("throw",e,s,u)})):n.resolve(p).then((function(e){i.value=e,s(i)}),(function(e){return r("throw",e,s,u)}))}u(l.arg)}var o;i(this,"_invoke",(function(e,t){function a(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(a,a):a()}),!0)}function I(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,I(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var a=d(o,t.i,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,f;var c=a.arg;return c?c.done?(n[t.r]=c.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,f):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function C(e){this.tryEntries=[[-1]],e.forEach(E,this),this.reset(!0)}function R(n){if(null!=n){var r=n[s];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,c=function t(){for(;++o<n.length;)if(a.call(n,o))return t.value=n[o],t.done=!1,t;return t.value=e,t.done=!0,t};return c.next=c}}throw new TypeError(t(n)+" is not iterable")}return m.prototype=v,i(w,"constructor",v),i(v,"constructor",m),m.displayName=i(v,l,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,i(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},n.awrap=function(e){return{__await:e}},b(k.prototype),i(k.prototype,u,(function(){return this})),n.AsyncIterator=k,n.async=function(e,t,r,o,a){void 0===a&&(a=Promise);var c=new k(p(e,t,r,o),a);return n.isGeneratorFunction(t)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},b(w),i(w,l,"Generator"),i(w,s,(function(){return this})),i(w,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},n.values=R,C.prototype={constructor:C,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){c.type="throw",c.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a[4],s=this.prev,u=a[1],l=a[2];if(-1===a[0])return r("end"),!1;if(!u&&!l)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=s){if(s<u)return this.method="next",this.arg=e,r(u),!0;if(s<l)return r(l),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var a=o?o[4]:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o[2],f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:R(t),r:n,n:r},"next"===this.method&&(this.arg=e),f}},n}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,c,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(l)throw o}}return s}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=c(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function c(e,t){if(e){if("string"==typeof e)return s(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n,r,o,a,c){try{var s=e[a](c),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){u(a,r,o,c,s,"next",e)}function s(e){u(a,r,o,c,s,"throw",e)}c(void 0)}))}}var i="#FF00FF",p="#FFFF99",d="Sheets",f="SheetSet",h="Revision number",m="Subset",v="ID",g="Handle",y="Sheet title",x="Layout name",w="Include for Publish",b="Custom Properties",k="Custom Sheet Set Properties",I="File Name",E="Relative File Name",S="UNC File Name",C=10,R=5;function N(e,t){var n=document.getElementById(e);n&&(n.onclick=t)}function A(){try{var e=localStorage.getItem("function-groups-state");return e?JSON.parse(e):{}}catch(e){return{}}}function L(){return B.apply(this,arguments)}function B(){return B=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,Excel.run(function(){var e=l(r().mark((function e(t){var n,o,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.workbook.getSelectedRange()).load("address"),o=F(),a=O(o),n.numberFormat="@",n.values=a,e.next=8,t.sync();case 8:console.log("dateStr ".concat(a)),console.log("The range address was ".concat(n.address,".")),console.log("ISO date ".concat(a," inserted."));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),B.apply(this,arguments)}function F(){var e=document.getElementById("date-picker");if(e&&e.value){var t=e.value.split("-"),n=parseInt(t[0],10),r=parseInt(t[1],10)-1,o=parseInt(t[2],10);return new Date(n,r,o)}return new Date}function O(e){var t=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function P(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()];return"".concat(t," ").concat(e.getDate(),", ").concat(e.getFullYear())}function U(){var e=F(),t=document.getElementById("date-iso-label");t&&(t.textContent=O(e));var n=document.getElementById("date-long-title-case-label");n&&(n.textContent=P(e));var r=document.getElementById("date-long-upper-case-label");r&&(r.textContent=P(e).toUpperCase())}function T(e){return V.apply(this,arguments)}function V(){return V=l(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=l(r().mark((function e(n){var o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=n.workbook.getSelectedRange()).numberFormat="@",o.values=t,e.next=5,n.sync();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),V.apply(this,arguments)}function D(){return M.apply(this,arguments)}function M(){return(M=l(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return t=F(),n=P(t).toUpperCase(),e.next=7,T(n);case 7:console.log("Long date (uppercase) ".concat(n," inserted.")),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function $(){return _.apply(this,arguments)}function _(){return(_=l(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return t=F(),n=P(t),e.next=7,T(n);case 7:console.log("Long date (title case) ".concat(n," inserted.")),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function j(e){return G.apply(this,arguments)}function G(){return G=l(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=l(r().mark((function e(n){var o,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=n.workbook.getSelectedRange()).load(["values"]),e.next=4,n.sync();case 4:return a=o.values.map((function(e){return e.map((function(e){var n=(null==e?void 0:e.toString())||"";return t(n)}))})),o.values=a,e.next=8,n.sync();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),G.apply(this,arguments)}function H(){return Y.apply(this,arguments)}function Y(){return(Y=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,j((function(e){return e.toLowerCase().replace(/(^[a-z])|\.\s+(.)/g,(function(e){return e.toUpperCase()}))}));case 5:console.log("Text converted to sentence case."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function J(){return z.apply(this,arguments)}function z(){return(z=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,j((function(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))}));case 5:console.log("Text converted to title case."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function W(){return q.apply(this,arguments)}function q(){return(q=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,j((function(e){return e.toUpperCase()}));case 5:console.log("Text converted to upper case."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function K(){return Z.apply(this,arguments)}function Z(){return(Z=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,j((function(e){return e.toLowerCase()}));case 5:console.log("Text converted to lower case."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function Q(){return X.apply(this,arguments)}function X(){return(X=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,T(" ");case 5:console.log("Non-breaking space inserted."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function ee(){return te.apply(this,arguments)}function te(){return te=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,Excel.run(function(){var e=l(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.workbook.getSelectedRange().numberFormat="General",e.next=4,t.sync();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:console.log("Cell format changed to General."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),te.apply(this,arguments)}function ne(){return re.apply(this,arguments)}function re(){return re=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,Excel.run(function(){var e=l(r().mark((function e(t){var n,o,a,c,s,u,l,i,h,m,v,g,y,x,w,I,E,S,C,R,N,A,L,B,F,O,P,U,T,V,D,M,$,_;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p,(o=t.workbook.worksheets).load("items/name"),e.next=5,t.sync();case 5:for(a=[f,d],c=[],s=0;s<o.items.length;s++)u=o.items[s],a.includes(u.name)&&c.push(u);for(0===c.length&&(console.log("No '".concat(f,"' or '").concat(d,"' worksheets found. Applying to active sheet.")),c.push(t.workbook.worksheets.getActiveWorksheet())),l=[],i=0,h=c;i<h.length;i++)m=h[i],(v=m.getUsedRange())&&(v.load(["rowIndex","rowCount","columnIndex","columnCount"]),l.push({worksheet:m,usedRange:v}));return e.next=13,t.sync();case 13:for(g=[],y=0,x=l;y<x.length;y++)if(w=x[y],I=w.worksheet,E=w.usedRange,S=I.name===f?k:I.name===d?b:null){for(C=[],R=0;R<E.rowCount;R++)(N=I.getRangeByIndexes(E.rowIndex+R,E.columnIndex,1,1)).load("values"),C.push(N);g.push({worksheet:I,usedRange:E,excludedRowName:S,headerCells:C})}if(!(g.length>0)){e.next=18;break}return e.next=18,t.sync();case 18:A=[],L=0,B=g;case 20:if(!(L<B.length)){e.next=34;break}F=B[L],O=F.worksheet,P=F.usedRange,U=F.excludedRowName,T=F.headerCells,V=0;case 23:if(!(V<T.length)){e.next=31;break}if((null===(D=T[V].values[0][0])||void 0===D?void 0:D.toString())!==U){e.next=28;break}return A.push({worksheet:O,usedRange:P,excludedRowIndex:P.rowIndex+V}),e.abrupt("break",31);case 28:V++,e.next=23;break;case 31:L++,e.next=20;break;case 34:M=r().mark((function e(){var t,o,a,c,s,u,l,i,p,d,f,h,m,v,g;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=_[$],o=t.worksheet,a=t.usedRange,c=A.find((function(e){return e.worksheet===o})),s=[],c&&c.excludedRowIndex>=a.rowIndex?(u=a.rowIndex,l=a.rowIndex+a.rowCount-1,i=c.excludedRowIndex,p=a.columnIndex,i>u&&(d=o.getRangeByIndexes(u,p,i-u,a.columnCount),s.push(d)),i<l&&(f=o.getRangeByIndexes(i+1,p,l-i,a.columnCount),s.push(f))):s.push(a),h=0,m=s;h<m.length;h++)v=m[h],(g=v.conditionalFormats.add(Excel.ConditionalFormatType.cellValue)).cellValue.format.fill.color=n,g.cellValue.rule={formula1:'=""',operator:Excel.ConditionalCellValueOperator.equalTo},console.log("Conditional formatting applied to ".concat(o.name," (excluding excluded row)."));case 5:case"end":return e.stop()}}),e)})),$=0,_=l;case 36:if(!($<_.length)){e.next=41;break}return e.delegateYield(M(),"t0",38);case 38:$++,e.next=36;break;case 41:return e.next=43,t.sync();case 43:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:console.log("Conditional formatting for empty cells applied."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error applying conditional formatting:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),re.apply(this,arguments)}function oe(){return ae.apply(this,arguments)}function ae(){return ae=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,Excel.run(function(){var e=l(r().mark((function e(t){var n,o,a,c,s,u,l,i,p,f,h,m,v,g,y,x,w,b,k,I,E,S,C;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getItem(d),o=t.workbook.getSelectedRange(),a=n.getUsedRange(),o.load(["values","columnIndex","columnCount"]),a.load(["columnIndex","columnCount"]),e.next=7,t.sync();case 7:for(c=[],s=0;s<o.columnCount;s++)u=o.columnIndex+s,(l=n.getRangeByIndexes(0,u,1,1)).load("values"),c.push(l);return e.next=11,t.sync();case 11:for(i=[],p=0,f=c;p<f.length;p++)m=f[p],(v=null===(h=m.values[0][0])||void 0===h?void 0:h.toString())&&!i.includes(v)&&i.push(v);for(g=a.columnIndex+1,y=a.columnIndex+a.columnCount,x=[],w=g;w<y;w++)(b=n.getRangeByIndexes(0,w,1,1)).load("values"),x.push(b);return e.next=19,t.sync();case 19:for(k=0;k<x.length;k++)if(E=x[k],S=null===(I=E.values[0][0])||void 0===I?void 0:I.toString(),!i.includes(S)){C=E.getEntireColumn();try{E.columnHidden=!0}catch(e){C.format.columnWidth=0}C.format.protection.locked=!0}return e.next=22,t.sync();case 22:console.log("Isolated subsets: ".concat(i.join(", ")));case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error isolating subset columns:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),ae.apply(this,arguments)}function ce(){return se.apply(this,arguments)}function se(){return se=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,Excel.run(function(){var e=l(r().mark((function e(t){var n,o,a,c,s,u,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getItem(d),(o=n.getUsedRange()).load(["columnIndex","columnCount"]),e.next=5,t.sync();case 5:for(a=o.columnIndex+1,c=o.columnIndex+o.columnCount,s=a;s<c;s++){u=n.getRangeByIndexes(0,s,1,1),l=u.getEntireColumn();try{u.columnHidden=!1}catch(e){l.format.columnWidth=8.43}l.format.protection.locked=!1}return e.next=10,t.sync();case 10:console.log("All columns unisolated.");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error unisolating columns:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),se.apply(this,arguments)}function ue(){return le.apply(this,arguments)}function le(){return le=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,Excel.run(function(){var e=l(r().mark((function e(t){var n,o,c,s,u,l,p,f,y,k,C,R,N,A,L,B,F,O,P,U,T,V,D,M,$,_;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getItem(d),(o=n.getUsedRange()).load(["rowCount","columnCount"]),e.next=5,t.sync();case 5:for(c=-1,s=new Set([m,g,v,w,x,I,E,S,b]),u=[],l=0;l<o.rowCount;l++)(p=n.getRangeByIndexes(l,0,1,1)).load("values"),u.push(p);return e.next=11,t.sync();case 11:f=0;case 12:if(!(f<u.length)){e.next=20;break}if((null===(y=u[f].values[0][0])||void 0===y?void 0:y.toString())!==h){e.next=17;break}return c=f,e.abrupt("break",20);case 17:f++,e.next=12;break;case 20:if(!(c<0)){e.next=23;break}return console.log("Revision number row not found."),e.abrupt("return");case 23:for(k=[],C=!1,R=0;R<u.length;R++)(A=null===(N=u[R].values[0][0])||void 0===N?void 0:N.toString())===b?C=!0:C&&A&&!s.has(A)&&k.push({name:A,row:R});if(0!==k.length){e.next=29;break}return console.log("No revision headers found."),e.abrupt("return");case 29:for(L=[],B=1;B<o.columnCount;B++){F=a(k);try{for(F.s();!(O=F.n()).done;)P=O.value,(U=n.getRangeByIndexes(P.row,B,1,1)).load("values"),L.push({cell:U,column:B,row:P.row})}catch(e){F.e(e)}finally{F.f()}}return e.next=33,t.sync();case 33:for(T=[],V=1;V<o.columnCount;V++)(D=n.getRangeByIndexes(c,V,1,1)).load("values"),T.push({cell:D,column:V});return e.next=37,t.sync();case 37:M=0,$=r().mark((function e(t){var n,o,a,c,s,u,l,p;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=null,o=0,a=L;o<a.length;o++)(c=a[o]).column===t&&(u=null===(s=c.cell.values[0][0])||void 0===s?void 0:s.toString())&&1===u.length&&/^[a-zA-Z0-9]$/.test(u)&&(n=u);n&&(p=T.find((function(e){return e.column===t})),(null===(l=p.cell.values[0][0])||void 0===l?void 0:l.toString())!==n&&(p.cell.values=[[n]],p.cell.format.fill.color=i,M++));case 3:case"end":return e.stop()}}),e)})),_=1;case 40:if(!(_<o.columnCount)){e.next=45;break}return e.delegateYield($(_),"t0",42);case 42:_++,e.next=40;break;case 45:return e.next=47,t.sync();case 47:M>0?console.log("".concat(M," change(s) made to ").concat(M," cell(s). They are highlighted in magenta.")):console.log("No changes made. Revision numbers are up to date.");case 48:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error checking latest revision:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),le.apply(this,arguments)}Office.onReady().then((function(e){var t;console.log("taskpane.js: Office.onReady promise resolved",e),e.host===Office.HostType.Excel&&(N("date-iso",L),N("date-long-title-case",$),N("date-long-upper-case",D),N("text-sentence-case",H),N("text-title-case",J),N("text-upper-case",W),N("text-lower-case",K),N("insert-non-breaking-space",Q),N("cell-format-general",ee),N("apply-conditional-empty",ne),N("isolate-subset",oe),N("unisolate-all",ce),N("check-latest-revision",ue),N("add-new-revision",ke),N("station-title-to",Ve),N("station-station-to",$e),N("station-sta-to",je),N("send-email",He),N("open-help",Je),N("find-replace-preview-btn",tt),N("find-replace-apply-btn",at),N("find-replace-get-find-btn",(function(){return Xe("find-replace-find-input")})),N("find-replace-get-replace-btn",(function(){return Xe("find-replace-replace-input")})),t=A(),document.querySelectorAll(".function-group-header").forEach((function(e){var n=e.querySelector(".group-title").textContent;if(n in t){var r=t[n],o=e.closest(".function-group").querySelector(".function-group-content");e.setAttribute("aria-expanded",r.toString()),o.style.display=r?"block":"none"}e.addEventListener("click",(function(){var t=e.closest(".function-group"),r="true"===e.getAttribute("aria-expanded"),o=t.querySelector(".function-group-content");r?(e.setAttribute("aria-expanded","false"),o.style.display="none"):(e.setAttribute("aria-expanded","true"),o.style.display="block"),function(e,t){try{var n=A();n[e]=t,localStorage.setItem("function-groups-state",JSON.stringify(n))}catch(e){}}(n,!r)}))})),function(){var e=document.getElementById("date-picker");if(e){var t=new Date,n=t.getFullYear(),r=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getDate().toString().padStart(2,"0");e.value="".concat(n,"-").concat(r,"-").concat(o),e.addEventListener("change",U),U()}}(),function(){try{Office.context.document.addHandlerAsync(Office.EventType.DocumentSelectionChanged,Ke,(function(e){e.status===Office.AsyncResultStatus.Failed&&console.error("Error setting up selection change listener for Get buttons:",e.error)}))}catch(e){console.error("Error initializing find/replace selection listener:",e)}var e=document.getElementById("find-replace-find-input"),t=document.getElementById("find-replace-replace-input");e&&(e.addEventListener("input",Qe),e.addEventListener("change",Qe)),t&&(t.addEventListener("input",Qe),t.addEventListener("change",Qe)),We()}())})).catch((function(e){console.error("taskpane.js: Office.onReady error",e)}));var ie=[],pe=null,de=[],fe=new Map;function he(){return me.apply(this,arguments)}function me(){return me=l(r().mark((function t(){var c;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Excel.run(function(){var t=l(r().mark((function t(c){var s,u,l,i,p,f,h,m,v,g,y,x,w,b,k,I,E,S,C,R,N,A,L,B,F,O,P,U,T,V,D,M,$,_,j,G;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=c.workbook.worksheets.getItem(d),(u=s.getUsedRange()).load(["rowCount","columnCount"]),t.next=5,c.sync();case 5:for(l=[],i=0;i<u.rowCount;i++)(p=s.getRangeByIndexes(i,0,1,1)).load("values"),l.push(p);return t.next=9,c.sync();case 9:for(f=new Map,h=0;h<l.length;h++)(v=null===(m=l[h].values[0][0])||void 0===m?void 0:m.toString())&&f.set(h,v);g=a(e),t.prev=12,g.s();case 14:if((y=g.n()).done){t.next=31;break}x=y.value,w=new Map,b=new Map,k=a(x.Filters);try{for(k.s();!(I=k.n()).done;)E=I.value,b.set(E.Name,{filter:E,rows:[]})}catch(e){k.e(e)}finally{k.f()}S=a(f.entries());try{for(S.s();!(C=S.n()).done;){R=o(C.value,2),N=R[0],A=R[1],L=a(x.Filters);try{for(L.s();!(B=L.n()).done;){F=B.value;try{O=new RegExp(F.Filter,"i"),(P=A.match(O))&&(U=0,P.length>1&&P[1]?U=parseInt(P[1],10):(T=A.match(/\d+/))&&(U=parseInt(T[0],10)),w.has(U)||w.set(U,new Map),w.get(U).set(F.Name,N),b.get(F.Name).rows.push(N))}catch(e){console.warn("Invalid regex pattern for filter ".concat(F.Name,": ").concat(F.Filter),e)}}}catch(e){L.e(e)}finally{L.f()}}}catch(e){S.e(e)}finally{S.f()}if(!(w.size>0)){t.next=29;break}V=[],D=Array.from(w.keys()).sort((function(e,t){return e-t})),M=a(b.entries());try{for(M.s();!($=M.n()).done;)_=o($.value,2),(j=_[1]).rows.length>0&&(G=n(new Set(j.rows)).sort((function(e,t){return e-t})),V.push({name:j.filter.Name,rows:G,isIncrement:j.filter.IsIncrement||!1,isPrepopulated:j.filter.IsPrepopulated||!1}))}catch(e){M.e(e)}finally{M.f()}if(!(V.length>0)){t.next=29;break}return t.abrupt("return",{name:x.Name,filters:V,blockNumbers:D});case 29:t.next=14;break;case 31:t.next=36;break;case 33:t.prev=33,t.t0=t.catch(12),g.e(t.t0);case 36:return t.prev=36,g.f(),t.finish(36);case 39:return t.abrupt("return",null);case 40:case"end":return t.stop()}}),t,null,[[12,33,36,39]])})));return function(e){return t.apply(this,arguments)}}());case 3:return c=t.sent,t.abrupt("return",c);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error detecting revision patterns:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),me.apply(this,arguments)}function ve(){return ge.apply(this,arguments)}function ge(){return ge=l(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=l(r().mark((function e(t){var n,o,a,c,s,u,l,i,p,f,h,v,g,x,w,b,k,I,E,S,C,R,N,A,L,B,F,O,P;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getItem(d),(o=n.getUsedRange()).load(["rowCount","columnCount"]),e.next=5,t.sync();case 5:for(a=-1,c=-1,s=[],u=0;u<o.rowCount;u++)(l=n.getRangeByIndexes(u,0,1,1)).load("values"),s.push(l);return e.next=11,t.sync();case 11:i=0;case 12:if(!(i<s.length)){e.next=20;break}if((f=null===(p=s[i].values[0][0])||void 0===p?void 0:p.toString())===m?a=i:f===y&&(c=i),!(a>=0&&c>=0)){e.next=17;break}return e.abrupt("break",20);case 17:i++,e.next=12;break;case 20:for(h=new Map,v=[],g=1;g<o.columnCount;g++)x=c>=0?n.getRangeByIndexes(c,g,1,1):null,w=a>=0?n.getRangeByIndexes(a,g,1,1):null,x&&x.load("values"),w&&w.load("values"),v.push({sheetTitleCell:x,subsetCell:w,column:g,fallbackCell:null});return e.next=25,t.sync();case 25:if(!(c<0)){e.next=29;break}for(b=1;b<o.columnCount;b++)(k=n.getRangeByIndexes(0,b,1,1)).load("values"),v[b-1].fallbackCell=k;return e.next=29,t.sync();case 29:for(I=0,E=v;I<E.length;I++)N=E[I],A=N.sheetTitleCell,L=N.subsetCell,B=N.column,F=N.fallbackCell,O=A?(null===(S=A.values[0][0])||void 0===S?void 0:S.toString())||"Unknown":F&&(null===(C=F.values[0][0])||void 0===C?void 0:C.toString())||"Unknown",P=L&&(null===(R=L.values[0][0])||void 0===R?void 0:R.toString())||"Unknown",h.has(P)||h.set(P,{name:P,sheets:[]}),h.get(P).sheets.push({name:O,columns:[B]});return e.abrupt("return",Array.from(h.values()));case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return t=e.sent,e.abrupt("return",t);case 7:return e.prev=7,e.t0=e.catch(0),console.error("Error getting sheet structure:",e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),ge.apply(this,arguments)}function ye(){return xe.apply(this,arguments)}function xe(){return(xe=l(r().mark((function e(){var t,o,c,s,u,l,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("sheet-selection-modal"),o=document.getElementById("sheet-selection-tree"),e.next=4,ve();case 4:if(0!==(c=e.sent).length){e.next=8;break}return console.error("No sheets found."),e.abrupt("return");case 8:o.innerHTML="",s=[],u=a(c),e.prev=11,i=r().mark((function e(){var t,n,c,u,i,p,d,f,h,m,v,g,y;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=l.value,(n=document.createElement("div")).style.marginBottom="12px",n.style.borderLeft="2px solid #0078d4",n.style.paddingLeft="8px",(c=document.createElement("div")).style.display="flex",c.style.alignItems="center",c.style.marginBottom="4px",(u=document.createElement("input")).type="checkbox",u.id="subset-".concat(t.name),u.checked=!0,u.style.marginRight="8px",u.style.cursor="pointer",(i=document.createElement("label")).htmlFor="subset-".concat(t.name),i.textContent=t.name,i.style.fontWeight="bold",i.style.cursor="pointer",c.appendChild(u),c.appendChild(i),n.appendChild(c),(p=document.createElement("div")).style.marginLeft="20px",d=[],f=a(t.sheets);try{for(f.s();!(h=f.n()).done;)m=h.value,(v=document.createElement("div")).style.marginBottom="4px",v.style.display="flex",v.style.alignItems="center",(g=document.createElement("input")).type="checkbox",g.id="sheet-".concat(t.name,"-").concat(m.name),g.value=m.name,g.checked=!0,g.style.marginRight="8px",g.dataset.columns=JSON.stringify(m.columns),g.dataset.subset=t.name,(y=document.createElement("label")).htmlFor="sheet-".concat(t.name,"-").concat(m.name),y.textContent=m.name,y.style.cursor="pointer",v.appendChild(g),v.appendChild(y),p.appendChild(v),d.push(g),s.push(g)}catch(e){f.e(e)}finally{f.f()}n.appendChild(p),o.appendChild(n),u.onchange=function(){d.forEach((function(e){e.checked=u.checked}))},d.forEach((function(e){e.onchange=function(){var e=d.every((function(e){return e.checked})),t=d.some((function(e){return e.checked}));u.checked=e,u.indeterminate=t&&!e}}));case 32:case"end":return e.stop()}}),e)})),u.s();case 14:if((l=u.n()).done){e.next=18;break}return e.delegateYield(i(),"t0",16);case 16:e.next=14;break;case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(11),u.e(e.t1);case 23:return e.prev=23,u.f(),e.finish(23);case 26:t.classList.add("show"),document.getElementById("select-all-sheets").onclick=function(){s.forEach((function(e){e.checked=!0})),c.forEach((function(e){var t=document.getElementById("subset-".concat(e.name));t&&(t.checked=!0,t.indeterminate=!1)}))},document.getElementById("deselect-all-sheets").onclick=function(){s.forEach((function(e){e.checked=!1})),c.forEach((function(e){var t=document.getElementById("subset-".concat(e.name));t&&(t.checked=!1,t.indeterminate=!1)}))},document.getElementById("sheet-selection-cancel").onclick=function(){t.classList.remove("show")},document.getElementById("sheet-selection-ok").onclick=function(){ie=[],s.forEach((function(e){if(e.checked){var t,r=JSON.parse(e.dataset.columns);(t=ie).push.apply(t,n(r))}})),0!==ie.length?(t.classList.remove("show"),we()):console.error("Please select at least one sheet.")};case 31:case"end":return e.stop()}}),e,null,[[11,20,23,26]])})))).apply(this,arguments)}function we(){return be.apply(this,arguments)}function be(){return(be=l(r().mark((function e(){var t,n,o,c,s,u,l,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("revision-entry-modal"),n=document.getElementById("revision-definition-info"),o=document.getElementById("revision-entry-fields"),c=document.getElementById("revision-warning"),e.next=6,he();case 6:if((pe=e.sent)&&pe.filters&&0!==pe.filters.length){e.next=14;break}return n.textContent="No revision patterns detected. Please ensure your sheet set has revision rows (e.g., REV-LINE1-#, REV-LINE1-DATE, etc.).",c.classList.add("show"),c.querySelector("#revision-warning-text").textContent="Could not auto-detect revision patterns. The function may not work correctly.",o.innerHTML="",t.classList.add("show"),e.abrupt("return");case 14:(s=pe.filters.map((function(e){return e.rows.length}))).every((function(e){return e===s[0]}))?c.classList.remove("show"):(c.classList.add("show"),c.querySelector("#revision-warning-text").textContent="Imperfect match detected. Row counts vary: ".concat(s.join(", "),". Proceed with caution.")),n.textContent="Auto-detected revision pattern: ".concat(pe.name),o.innerHTML="",u=a(pe.filters),e.prev=20,i=r().mark((function e(){var t,n,a,c,s,u,i,p,d,f,h,m,v,g;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=l.value,(n=document.createElement("div")).style.marginBottom="15px",(a=document.createElement("label")).className="ms-font-s",a.style.display="block",a.style.marginBottom="5px",a.style.fontWeight=t.isIncrement?"bold":"normal",a.textContent="".concat(t.name," (rows: ").concat(t.rows.join(", "),")"),n.appendChild(a),t.isIncrement?((c=document.createElement("div")).style.marginBottom="5px",(s=document.createElement("label")).className="ms-font-s",s.textContent="Increment, start value: ",c.appendChild(s),(u=document.createElement("select")).id="filter-".concat(t.name,"-start"),u.style.marginLeft="5px",u.style.padding="4px",[{value:"1",text:"1",selected:!0},{value:"A",text:"A",selected:!1},{value:"0",text:"0",selected:!1}].forEach((function(e){var t=document.createElement("option");t.value=e.value,t.textContent=e.text,e.selected&&(t.selected=!0),u.appendChild(t)})),c.appendChild(u),n.appendChild(c),t.startValue=u.value,u.onchange=function(){t.startValue=u.value}):t.name.toUpperCase().includes("DATE")?((i=document.createElement("input")).type="date",i.id="filter-".concat(t.name),i.className="ms-TextField-field",i.style.width="100%",i.style.padding="6px",p=new Date,i.value="".concat(p.getFullYear(),"-").concat(String(p.getMonth()+1).padStart(2,"0"),"-").concat(String(p.getDate()).padStart(2,"0")),n.appendChild(i)):(d=Be(t.name),f=d.slice(0,R),(h=document.createElement("div")).style.position="relative",h.style.width="100%",h.style.display="flex",h.style.alignItems="stretch",(m=document.createElement("input")).type="text",m.id="filter-".concat(t.name),m.className="ms-TextField-field",m.style.width="100%",m.style.padding="6px",m.style.paddingRight=f.length>0?"30px":"6px",m.style.boxSizing="border-box",m.placeholder="Enter ".concat(t.name," value"),f.length>0&&(m.value=f[0]),h.appendChild(m),f.length>0&&((v=document.createElement("button")).type="button",v.innerHTML="▼",v.style.position="absolute",v.style.right="2px",v.style.top="2px",v.style.bottom="2px",v.style.width="26px",v.style.border="none",v.style.background="transparent",v.style.cursor="pointer",v.style.padding="0",v.style.fontSize="10px",v.style.color="#666",(g=document.createElement("div")).style.display="none",g.style.position="absolute",g.style.top="100%",g.style.left="0",g.style.right="0",g.style.backgroundColor="white",g.style.border="1px solid #ccc",g.style.borderTop="none",g.style.maxHeight="150px",g.style.overflowY="auto",g.style.zIndex="1000",g.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)",f.forEach((function(e){var t=document.createElement("div");t.style.padding="6px",t.style.cursor="pointer",t.textContent=e,t.style.borderBottom="1px solid #f0f0f0",t.onmouseover=function(){t.style.backgroundColor="#f3f2f1"},t.onmouseout=function(){t.style.backgroundColor="white"},t.onclick=function(){m.value=e,g.style.display="none",m.focus()},g.appendChild(t)})),v.onclick=function(e){e.stopPropagation(),g.style.display="none"===g.style.display?"block":"none"},document.addEventListener("click",(function(e){h.contains(e.target)||(g.style.display="none")})),h.appendChild(v),h.appendChild(g)),n.appendChild(h)),o.appendChild(n);case 12:case"end":return e.stop()}}),e)})),u.s();case 23:if((l=u.n()).done){e.next=27;break}return e.delegateYield(i(),"t0",25);case 25:e.next=23;break;case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(20),u.e(e.t1);case 32:return e.prev=32,u.f(),e.finish(32);case 35:t.classList.add("show"),document.getElementById("revision-entry-cancel").onclick=function(){t.classList.remove("show")},document.getElementById("revision-entry-apply").onclick=function(){var e,n=a(pe.filters);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(!r.isIncrement){var o=document.getElementById("filter-".concat(r.name));o&&(r.value=o.value.trim())}}}catch(e){n.e(e)}finally{n.f()}t.classList.remove("show"),Ue()};case 38:case"end":return e.stop()}}),e,null,[[20,29,32,35]])})))).apply(this,arguments)}function ke(){return Ie.apply(this,arguments)}function Ie(){return Ie=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=l(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.workbook.worksheets.getActiveWorksheet()).load("name"),e.next=4,t.sync();case 4:if(n.name===d){e.next=7;break}return console.error('Please switch to the "'.concat(d,'" worksheet before running this function.')),e.abrupt("return");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return e.next=5,ye();case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error setting up add new revision:",e.t0),console.error("Error: ".concat(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),Ie.apply(this,arguments)}function Ee(e){if(!e)return!0;var t=e.toString().trim();return"%%U"===t||"-"===t||"_"===t||""===t}function Se(e){if(!e)return!1;var t=e.toString();return!Ee(t)&&/[a-zA-Z0-9]/.test(t)}function Ce(e){if(!e)return"A";var t=e.toString().trim();if(/^\d$/.test(t))return(parseInt(t,10)+1).toString();if(/^[a-zA-Z]$/.test(t)){var n=t.toUpperCase();return"Z"===n?"A":String.fromCharCode(n.charCodeAt(0)+1)}return"A"}function Re(e,t){return Ne.apply(this,arguments)}function Ne(){return Ne=l(r().mark((function e(t,n){var o,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.filters.find((function(e){return e.isIncrement}))){e.next=3;break}return e.abrupt("return",-1);case 3:return e.next=5,Excel.run(function(){var e=l(r().mark((function e(c){var s,u,l,i,p,f,h,m,v,g,y,x,w,b,k,I;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=c.workbook.worksheets.getItem(d),!o.isPrepopulated){e.next=18;break}for(u=n.filters.filter((function(e){return!e.isIncrement&&!e.isPrepopulated})),l=[],i=0;i<o.rows.length;i++){p=[],f=a(u);try{for(f.s();!(h=f.n()).done;)m=h.value,i<m.rows.length&&((v=s.getRangeByIndexes(m.rows[i],t,1,1)).load("values"),p.push(v))}catch(e){f.e(e)}finally{f.f()}l.push(p)}return e.next=7,c.sync();case 7:g=0;case 8:if(!(g<l.length)){e.next=16;break}if(y=l[g],x=y.every((function(e){return Ee(e.values[0][0])})),!x){e.next=13;break}return e.abrupt("return",g);case 13:g++,e.next=8;break;case 16:e.next=30;break;case 18:for(w=[],b=0;b<o.rows.length;b++)(k=s.getRangeByIndexes(o.rows[b],t,1,1)).load("values"),w.push(k);return e.next=22,c.sync();case 22:I=0;case 23:if(!(I<w.length)){e.next=30;break}if(Se(w[I].values[0][0])){e.next=27;break}return e.abrupt("return",I);case 27:I++,e.next=23;break;case 30:return e.abrupt("return",-1);case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)}))),Ne.apply(this,arguments)}function Ae(e){return Le.apply(this,arguments)}function Le(){return(Le=l(r().mark((function e(t){var n,o,a,c,s,u,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getItem(d),(o=n.getUsedRange()).load(["rowCount"]),e.next=5,t.sync();case 5:for(a=[],c=0;c<o.rowCount;c++)(s=n.getRangeByIndexes(c,0,1,1)).load("values"),a.push(s);return e.next=9,t.sync();case 9:u=0;case 10:if(!(u<a.length)){e.next=17;break}if((null===(l=a[u].values[0][0])||void 0===l?void 0:l.toString())!==h){e.next=14;break}return e.abrupt("return",u);case 14:u++,e.next=10;break;case 17:return e.abrupt("return",-1);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Be(e){try{var t="revision-mru-".concat(e),n=localStorage.getItem(t);return n?JSON.parse(n):[]}catch(e){return[]}}function Fe(e,t){if(t&&""!==t.trim())try{var n="revision-mru-".concat(e),r=Be(e).filter((function(e){return e!==t}));r.unshift(t);var o=r.slice(0,C);localStorage.setItem(n,JSON.stringify(o))}catch(e){}}function Oe(){return Pe.apply(this,arguments)}function Pe(){return Pe=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=l(r().mark((function e(t){var n,o,c,s,u,l,p,d,f,h,m,v,g,y,x,w,b,k,I,E,S,C,R,N,A,L,B;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.workbook.worksheets).load("items"),e.next=4,t.sync();case 4:o=[],c=a(n.items);try{for(c.s();!(s=c.n()).done;)u=s.value,(l=u.getUsedRange())&&(l.load(["rowCount","columnCount","rowIndex","columnIndex"]),o.push({worksheet:u,usedRange:l}))}catch(e){c.e(e)}finally{c.f()}if(!(o.length>0)){e.next=10;break}return e.next=10,t.sync();case 10:for(p=[],d=0,f=o;d<f.length;d++)for(h=f[d],m=h.worksheet,v=h.usedRange,g=v.rowIndex,y=v.columnIndex,x=v.rowCount,w=v.columnCount,b=0;b<x;b++)for(k=0;k<w;k++)(I=m.getRangeByIndexes(g+b,y+k,1,1)).load(["format/fill/color","format/protection/locked"]),p.push(I);if(!(p.length>0)){e.next=15;break}return e.next=15,t.sync();case 15:for(E=[],S=0,C=p;S<C.length;S++)R=C[S],N=R.format.fill.color,A=R.format.protection.locked,("string"==typeof N?N:null==N?void 0:N.toString())!==i||A||E.push(R);if(E.length>0){L=a(E);try{for(L.s();!(B=L.n()).done;)B.value.format.fill.clear()}catch(e){L.e(e)}finally{L.f()}}return e.next=20,t.sync();case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("Note: Could not clear highlighted cells:",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),Pe.apply(this,arguments)}function Ue(){return Te.apply(this,arguments)}function Te(){return Te=l(r().mark((function e(){var t,n,o,c,s,u,p,f,h;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pe&&ie&&0!==ie.length){e.next=3;break}return console.error("No revision definition or columns selected."),e.abrupt("return");case 3:return e.prev=3,e.next=6,Oe();case 6:t=[],n=a(ie),e.prev=8,n.s();case 10:if((o=n.n()).done){e.next=18;break}return c=o.value,e.next=14,Re(c,pe);case 14:s=e.sent,t.push({column:c,startingIndex:s});case 16:e.next=10;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),n.e(e.t0);case 23:return e.prev=23,n.f(),e.finish(23);case 26:return e.next=28,Excel.run(function(){var e=l(r().mark((function e(n){var o,c,s,u,l,p,f,h,m,v,g,y,x,w,b,k,I,E,S,C,R,N,A,L,B,F,O,P,U,T,V,D,M,$,_,j,G,H,Y,J,z,W,q,K,Z,Q,X,ee,te,ne,re,oe,ae,ce,se,ue;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.workbook.worksheets.getItem(d),c=0,e.next=4,Ae(n);case 4:s=e.sent,u=[],l=[],p=0,f=t;case 8:if(!(p<f.length)){e.next=64;break}if(h=f[p],m=h.column,v=h.startingIndex,g=pe.filters.find((function(e){return e.isIncrement})),y={column:m,startingIndex:v,incrementFilter:g,revNumRow:s,operations:[]},!(v>=0)){e.next=36;break}x=a(pe.filters),e.prev=14,x.s();case 16:if((w=x.n()).done){e.next=26;break}if(b=w.value,!(v>=b.rows.length)){e.next=20;break}return e.abrupt("continue",24);case 20:k=o.getRangeByIndexes(b.rows[v],m,1,1),I={type:"write",cell:k,filter:b,column:m,startingIndex:v},b.isIncrement?b.isPrepopulated?(k.load("values"),u.push({cell:k,op:I,type:"prepopulated"})):v>0?((E=o.getRangeByIndexes(b.rows[v-1],m,1,1)).load("values"),u.push({cell:E,op:I,type:"prev"})):I.value=b.startValue||"A":I.value=b.value,y.operations.push(I);case 24:e.next=16;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(14),x.e(e.t0);case 31:return e.prev=31,x.f(),e.finish(31);case 34:e.next=60;break;case 36:S=a(pe.filters);try{for(S.s();!(C=S.n()).done;)for(R=C.value,N=1;N<R.rows.length;N++)A=o.getRangeByIndexes(R.rows[N],m,1,1),L=o.getRangeByIndexes(R.rows[N-1],m,1,1),A.load("values"),u.push({cell:A,op:{type:"shift",srcCell:A,tgtCell:L,column:m}})}catch(e){S.e(e)}finally{S.f()}B=g.rows.length-1,F=a(pe.filters),e.prev=40,F.s();case 42:if((O=F.n()).done){e.next=52;break}if(P=O.value,!(B>=P.rows.length)){e.next=46;break}return e.abrupt("continue",50);case 46:U=o.getRangeByIndexes(P.rows[B],m,1,1),T={type:"write",cell:U,filter:P,column:m,startingIndex:B},P.isIncrement?P.isPrepopulated||(B>0?((V=o.getRangeByIndexes(P.rows[B-1],m,1,1)).load("values"),u.push({cell:V,op:T,type:"prev"})):T.value=P.startValue||"A"):T.value=P.value,y.operations.push(T);case 50:e.next=42;break;case 52:e.next=57;break;case 54:e.prev=54,e.t1=e.catch(40),F.e(e.t1);case 57:return e.prev=57,F.f(),e.finish(57);case 60:l.push(y);case 61:p++,e.next=8;break;case 64:if(!(u.length>0)){e.next=67;break}return e.next=67,n.sync();case 67:for(D=0,M=u;D<M.length;D++)"prev"===($=M[D]).type?(j=null===(_=$.cell.values[0][0])||void 0===_?void 0:_.toString(),$.op.value=Ce(j)):"prepopulated"===$.type?$.op.value=null===(G=$.cell.values[0][0])||void 0===G?void 0:G.toString():"shift"===$.op.type&&($.op.tgtCell.values=$.cell.values,$.op.tgtCell.format.fill.color=i,c++);for(H=0,Y=l;H<Y.length;H++){J=Y[H],z=null,W=a(J.operations);try{for(W.s();!(q=W.n()).done;)"write"===(K=q.value).type&&void 0!==K.value&&(K.cell.values=[[K.value]],K.cell.format.fill.color=i,c++,K.filter.isIncrement&&(z=K.value))}catch(e){W.e(e)}finally{W.f()}z&&s>=0&&o.getRangeByIndexes(s,J.column,1,1).load("values")}for(Z=[],Q=0,X=l;Q<X.length;Q++)(ee=X[Q]).operations.some((function(e){var t;return(null===(t=e.filter)||void 0===t?void 0:t.isIncrement)&&e.value}))&&(te=ee.operations.find((function(e){var t;return(null===(t=e.filter)||void 0===t?void 0:t.isIncrement)&&e.value})),s>=0&&((ne=o.getRangeByIndexes(s,ee.column,1,1)).load("values"),Z.push({cell:ne,value:te.value})));if(!(Z.length>0)){e.next=74;break}return e.next=74,n.sync();case 74:for(re=0,oe=Z;re<oe.length;re++)ce=oe[re],se=ce.cell,ue=ce.value,(null===(ae=se.values[0][0])||void 0===ae?void 0:ae.toString())!==ue&&(se.values=[[ue]],se.format.fill.color=i,c++);return e.next=77,n.sync();case 77:return e.abrupt("return",c);case 78:case"end":return e.stop()}}),e,null,[[14,28,31,34],[40,54,57,60]])})));return function(t){return e.apply(this,arguments)}}());case 28:u=e.sent,p=a(pe.filters);try{for(p.s();!(f=p.n()).done;)!(h=f.value).isIncrement&&h.value&&Fe(h.name,h.value)}catch(e){p.e(e)}finally{p.f()}u>0?console.log("".concat(u," change(s) made to ").concat(u," cell(s). They are highlighted in magenta.")):console.log("No changes made."),e.next=38;break;case 34:e.prev=34,e.t1=e.catch(3),console.error("Error applying revisions:",e.t1),console.error("Error: ".concat(e.t1.message));case 38:case"end":return e.stop()}}),e,null,[[3,34],[8,20,23,26]])}))),Te.apply(this,arguments)}function Ve(){return De.apply(this,arguments)}function De(){return De=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,Excel.run(function(){var e=l(r().mark((function e(t){var n,o,a,c,s,u,l,i,p,f,h,m,v,g,x;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getItem(d),(o=t.workbook.getSelectedRange()).load(["columnIndex","columnCount","rowIndex","rowCount"]),e.next=5,t.sync();case 5:for(a=o.columnIndex,c=a+o.columnCount-1,s=a;s<=c;s++)for(u=Me(s),l="$A:".concat(u),i='VLOOKUP("'.concat(y,'",').concat(l,",COLUMN(),FALSE)"),p='VLOOKUP("STA-BEGIN",'.concat(l,",COLUMN(),FALSE)"),f='VLOOKUP("STA-END",'.concat(l,",COLUMN(),FALSE)"),h="OR(".concat(p,'=" ",').concat(p,'="",').concat(p,'="#+###",').concat(p,'="-")'),m="OR(".concat(f,'=" ",').concat(f,'="",').concat(f,'="#+###",').concat(f,'="-")'),v="=".concat(i,"&IF(").concat(h,',""," - Station "&').concat(p,")&IF(").concat(m,',""," to "&').concat(f,")"),g=o.rowIndex;g<o.rowIndex+o.rowCount;g++)(x=n.getRangeByIndexes(g,s,1,1)).numberFormat="General",x.formulas=[[v]];return e.next=10,t.sync();case 10:console.log("Concatenated station title formula applied.");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error creating concatenated station title:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),De.apply(this,arguments)}function Me(e){for(var t="",n=e+1;n>0;){var r=(n-1)%26;t=String.fromCharCode(65+r)+t,n=Math.floor((n-1)/26)}return t}function $e(){return _e.apply(this,arguments)}function _e(){return _e=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,Excel.run(function(){var e=l(r().mark((function e(t){var n,o,a,c,s,u,l,i,p,f,h,m,v,g;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getItem(d),(o=t.workbook.getSelectedRange()).load(["columnIndex","columnCount","rowIndex","rowCount"]),e.next=5,t.sync();case 5:for(a=o.columnIndex,c=a+o.columnCount-1,s=a;s<=c;s++)for(u=Me(s),l="$A:".concat(u),i='VLOOKUP("STA-BEGIN",'.concat(l,",COLUMN(),FALSE)"),p='VLOOKUP("STA-END",'.concat(l,",COLUMN(),FALSE)"),f="OR(".concat(i,'=" ",').concat(i,'="",').concat(i,'="#+###",').concat(i,'="-")'),h="OR(".concat(p,'=" ",').concat(p,'="",').concat(p,'="#+###",').concat(p,'="-")'),m="=IF(".concat(f,',"","Station "&').concat(i,")&IF(").concat(h,',""," to "&').concat(p,")"),v=o.rowIndex;v<o.rowIndex+o.rowCount;v++)(g=n.getRangeByIndexes(v,s,1,1)).numberFormat="General",g.formulas=[[m]];return e.next=10,t.sync();case 10:console.log("Concatenated station formula applied.");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error creating concatenated station:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),_e.apply(this,arguments)}function je(){return Ge.apply(this,arguments)}function Ge(){return Ge=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:return e.next=5,Excel.run(function(){var e=l(r().mark((function e(t){var n,o,a,c,s,u,l,i,p,f,h,m,v,g;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getItem(d),(o=t.workbook.getSelectedRange()).load(["columnIndex","columnCount","rowIndex","rowCount"]),e.next=5,t.sync();case 5:for(a=o.columnIndex,c=a+o.columnCount-1,s=a;s<=c;s++)for(u=Me(s),l="$A:".concat(u),i='VLOOKUP("STA-BEGIN",'.concat(l,",COLUMN(),FALSE)"),p='VLOOKUP("STA-END",'.concat(l,",COLUMN(),FALSE)"),f="OR(".concat(i,'=" ",').concat(i,'="",').concat(i,'="#+###",').concat(i,'="-")'),h="OR(".concat(p,'=" ",').concat(p,'="",').concat(p,'="#+###",').concat(p,'="-")'),m="=IF(".concat(f,',"","STA "&').concat(i,")&IF(").concat(h,',""," TO "&').concat(p,")"),v=o.rowIndex;v<o.rowIndex+o.rowCount;v++)(g=n.getRangeByIndexes(v,s,1,1)).numberFormat="General",g.formulas=[[m]];return e.next=10,t.sync();case 10:console.log("Concatenated STA formula applied.");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error creating concatenated STA:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),Ge.apply(this,arguments)}function He(){return Ye.apply(this,arguments)}function Ye(){return(Ye=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{window.location.href="mailto:".concat("support@example.com","?subject=").concat(encodeURIComponent("Sheet Set Toolkit Support Request")),console.log("Email client opened.")}catch(e){console.error(e)}case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Je(){return ze.apply(this,arguments)}function ze(){return(ze=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{window.open("https://urbanpulse.sharepoint.com/sites/pulse/connect-site/Teams/DPT/Wiki/Pages/Plug-ins/Excel%20Sheet%20Set%20Editor.aspx","_blank"),console.log("Help page opened.")}catch(e){console.error(e)}case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function We(){return qe.apply(this,arguments)}function qe(){return qe=l(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=l(r().mark((function e(t){var n,o,a,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.workbook.getSelectedRange()).load(["rowCount","columnCount"]),e.next=4,t.sync();case 4:o=1===n.rowCount&&1===n.columnCount,a=document.getElementById("find-replace-get-find-btn"),c=document.getElementById("find-replace-get-replace-btn"),a&&(a.disabled=!o),c&&(c.disabled=!o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=11;break;case 5:e.prev=5,e.t0=e.catch(0),t=document.getElementById("find-replace-get-find-btn"),n=document.getElementById("find-replace-get-replace-btn"),t&&(t.disabled=!0),n&&(n.disabled=!0);case 11:case"end":return e.stop()}}),e,null,[[0,5]])}))),qe.apply(this,arguments)}function Ke(){return Ze.apply(this,arguments)}function Ze(){return(Ze=l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qe(){var e=document.getElementById("find-replace-apply-btn");e&&(e.disabled=!0),de=[],fe.clear()}function Xe(e){return et.apply(this,arguments)}function et(){return et=l(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=l(r().mark((function e(n){var o,a,c,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=n.workbook.getSelectedRange()).load(["values"]),e.next=4,n.sync();case 4:(a=document.getElementById(t))&&((c=o.values)&&Array.isArray(c)&&c.length>0&&Array.isArray(c[0])&&c[0].length>0?(s=c[0][0],a.value=(null==s?void 0:s.toString())||"",Qe()):(a.value="",Qe()));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("Could not get cell value from selection:",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),et.apply(this,arguments)}function tt(){return nt.apply(this,arguments)}function nt(){return nt=l(r().mark((function e(){var t,n,o,a,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:if(t=document.getElementById("find-replace-find-input"),n=document.getElementById("find-replace-apply-btn"),o=document.getElementById("find-replace-results"),a=document.getElementById("find-replace-results-list"),t&&n&&o&&a){e.next=10;break}return console.error("Find/Replace UI elements not found"),e.abrupt("return");case 10:if(c=t.value.trim()){e.next=14;break}return console.log("Find value is empty"),e.abrupt("return");case 14:return de=[],fe.clear(),a.innerHTML="",e.next=19,Excel.run(function(){var e=l(r().mark((function e(t){var s,u,l,i,p,d,f,h,m,v,g,y,x,w,b,k,I,E,S,C,R,N,A,L,B,F,O,P,U,T,V,D,M;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.workbook.worksheets.getActiveWorksheet(),u=s.getUsedRange()){e.next=5;break}return console.log("No used range found"),e.abrupt("return");case 5:return u.load(["rowIndex","columnIndex","rowCount","columnCount"]),e.next=8,t.sync();case 8:for(l=u.rowIndex,i=u.columnIndex,p=u.rowCount,d=u.columnCount,f=[],h=0;h<p;h++)for(m=0;m<d;m++)(v=s.getRangeByIndexes(l+h,i+m,1,1)).load(["values","format/protection/locked"]),f.push({cell:v,row:l+h,col:i+m});for(g=[],y=0;y<p;y++)(x=s.getRangeByIndexes(l+y,i,1,1)).load("values"),g.push(x);return e.next=18,t.sync();case 18:for(w=[],b=0;b<g.length;b++)I=(null===(k=g[b].values[0][0])||void 0===k?void 0:k.toString())||"",w.push(I);for(E=[],S=0;S<f.length;S++)C=f[S],R=C.cell,N=C.row,A=C.col,L=R.values[0][0],B=(null==L?void 0:L.toString())||"",R.format.protection.locked||B!==c||(F=st(N,A),O=w[N-l]||"",E.push({row:N,col:A,address:F,rowHeader:O}));for(P=new Map,U=0,T=E;U<T.length;U++)V=T[U],D=V.rowHeader||"(No header)",P.has(D)||P.set(D,{header:D,cells:[],selected:!0}),P.get(D).cells.push(V);fe=P,de=E,E.length>0?(rt(P,a),o.classList.remove("find-replace-results-hidden"),ot()):((M=document.createElement("div")).className="find-replace-result-item",M.textContent="No matching unlocked cells found",a.appendChild(M),o.classList.remove("find-replace-results-hidden"),n.disabled=!0);case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 19:console.log("Preview complete: ".concat(de.length," matching unlocked cells found")),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),console.error("Error previewing find/replace:",e.t0);case 25:case"end":return e.stop()}}),e,null,[[0,22]])}))),nt.apply(this,arguments)}function rt(e,t){t.innerHTML="";var n,r=a(e.entries());try{var c=function(){var e=o(n.value,2),r=e[0],a=e[1],c=document.createElement("div");c.className="find-replace-row-group";var s=document.createElement("div");s.className="find-replace-row-header",s.setAttribute("aria-expanded","false");var u=document.createElement("span");u.className="find-replace-toggle-indicator",u.textContent="▶",u.setAttribute("aria-hidden","true");var l=document.createElement("input");l.type="checkbox",l.id="find-replace-checkbox-".concat(r),l.checked=a.selected,l.className="find-replace-row-checkbox",l.addEventListener("change",(function(e){e.stopPropagation(),a.selected=e.target.checked,function(e,t){var n=fe.get(e);if(n){n.selected=t;var r=document.getElementById("find-replace-checkbox-".concat(e));r&&(r.checked=t)}}(r,e.target.checked),ot()}));var i=document.createElement("label");i.htmlFor=l.id,i.className="find-replace-row-header-label",i.textContent=r||"(No header)",i.addEventListener("click",(function(e){e.stopPropagation()})),s.addEventListener("click",(function(e){var t=e.target;t===l||t===i||t.closest("input[type='checkbox']")||t.closest("label")||function(e,t,n){"true"===e.getAttribute("aria-expanded")?(e.setAttribute("aria-expanded","false"),t.classList.add("find-replace-row-cells-collapsed"),n.textContent="▶"):(e.setAttribute("aria-expanded","true"),t.classList.remove("find-replace-row-cells-collapsed"),n.textContent="▼")}(s,p,u)})),s.appendChild(u),s.appendChild(l),s.appendChild(i);var p=document.createElement("div");p.className="find-replace-row-cells find-replace-row-cells-collapsed",a.cells.forEach((function(e){var t=document.createElement("div");t.className="find-replace-result-item",t.textContent=e.address,p.appendChild(t)})),c.appendChild(s),c.appendChild(p),t.appendChild(c)};for(r.s();!(n=r.n()).done;)c()}catch(e){r.e(e)}finally{r.f()}}function ot(){var e=document.getElementById("find-replace-apply-btn");if(e){var t,n=!1,r=a(fe.entries());try{for(r.s();!(t=r.n()).done;)if(o(t.value,2)[1].selected){n=!0;break}}catch(e){r.e(e)}finally{r.f()}e.disabled=!n}}function at(){return ct.apply(this,arguments)}function ct(){return ct=l(r().mark((function e(){var t,c,s,u,p,d,f,h,m,v,g;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe();case 3:if(t=document.getElementById("find-replace-replace-input"),c=document.getElementById("find-replace-apply-btn"),s=document.getElementById("find-replace-results"),u=document.getElementById("find-replace-results-list"),t&&c&&s&&u){e.next=10;break}return console.error("Find/Replace UI elements not found"),e.abrupt("return");case 10:p=[],d=a(fe.entries());try{for(d.s();!(f=d.n()).done;)h=o(f.value,2),(m=h[1]).selected&&p.push.apply(p,n(m.cells))}catch(e){d.e(e)}finally{d.f()}if(0!==p.length){e.next=16;break}return console.log("No cells selected for replacement"),e.abrupt("return");case 16:return v=t.value,g=0,e.next=20,Excel.run(function(){var e=l(r().mark((function e(t){var n,o,a,c,s,u,l,d,f,h;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.workbook.worksheets.getActiveWorksheet(),o=[],a=0,c=p;a<c.length;a++)s=c[a],(u=n.getRangeByIndexes(s.row,s.col,1,1)).load("values"),o.push(u);return e.next=5,t.sync();case 5:for(l=0,d=o;l<d.length;l++)h=d[l],((null===(f=h.values[0][0])||void 0===f?void 0:f.toString())||"")!==v&&(h.values=[[v]],h.format.fill.color=i,g++);return e.next=8,t.sync();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 20:de=[],fe.clear(),u.innerHTML="",s.classList.add("find-replace-results-hidden"),c.disabled=!0,g>0?console.log("".concat(g," change(s) made to ").concat(g," cell(s). They are highlighted in magenta.")):console.log("No changes made. All selected cells already contain the replace value."),e.next=31;break;case 28:e.prev=28,e.t0=e.catch(0),console.error("Error applying find/replace:",e.t0);case 31:case"end":return e.stop()}}),e,null,[[0,28]])}))),ct.apply(this,arguments)}function st(e,t){for(var n=e+1,r="",o=t+1;o>0;){var a=(o-1)%26;r=String.fromCharCode(65+a)+r,o=Math.floor((o-1)/26)}return"".concat(r).concat(n)}}(),e=x(385),t=x.n(e),n=new URL(x(394),x.b),r=new URL(x(220),x.b),o=new URL(x(410),x.b),a=new URL(x(886),x.b),c=new URL(x(909),x.b),s=new URL(x(914),x.b),u=new URL(x(773),x.b),l=new URL(x(606),x.b),i=new URL(x(931),x.b),p=new URL(x(682),x.b),d=new URL(x(416),x.b),f=new URL(x(646),x.b),h=new URL(x(655),x.b),m=new URL(x(852),x.b),v=new URL(x(111),x.b),t()(n),t()(r),t()(o),t()(a),t()(c),t()(s),t()(u),t()(l),t()(i),t()(p),t()(d),t()(f),t()(h),t()(m),t()(v)}();
//# sourceMappingURL=taskpane.js.map